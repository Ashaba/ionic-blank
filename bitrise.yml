---
format_version: '8'
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git
project_type: ionic
trigger_map:
- push_branch: "master"
  workflow: build
- pull_request_source_branch: "*"
  workflow: build
- tag: "*"
  workflow: deploy
workflows:
  deploy:
    steps:
    - npm@1.1.0:
        inputs:
        - command: install
    # - generate-cordova-build-configuration@0.9.6: {}
    # Android
    - ionic-archive@2.1.0:
        inputs:
        - platform: "android"
        - run_ionic_prepare: "true"
        - target: device
        - configuration: release
    - deploy-to-bitrise-io@1.9.2: {}
    before_run:
    - build
  build:
    steps:
    - certificate-and-profile-installer@1.10.1: {}
    - npm@1.1.0:
        inputs:
        - command: install
